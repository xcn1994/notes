# TCP/IP

## TCP协议

提供可靠的连接服务，保证数据传输过程中的完整性。

## 使用三次握手方式建立连接。

第一次握手：

客户端发送 SYN 包（syn=j）到服务器，客户端进入 SYN_SEND 状态。

超时后会多次发送尝试，失败后通知连接失败。

第二次握手：

服务器接收到 SYN 包，需确认 SYN 是否是该客户端发送的包，并将自己的 SYN 包一同返回给客户端。

区分客户端校验的 SYN 包为 ack = j + 1， 服务器为 syn=k 包。

发送后服务器进入 SYN_RECV 状态， 等待连接。

第三次握手：

客户端收到服务器的 SYN+ACK 包后，向服务器发送校验成功，确认包 ACK（ack = k +1） 包。

发送后，客户端与服务器进入 ESTABLISHED 状态，握手成功，建立连接。

## 四次挥手的方式断开连接

双方都可以进行断开连接请求

第一次挥手：

客户端发送 FIN 和一个序号到服务器，进入 FIN_WAIT_1 状态。

第二次挥手：

服务器接受到 FIN 包和序号，将 ack = 序号+1返回给客户端，并进入 CLOSE_WAIT 状态。

第三次挥手：

服务器发送一个 FIN， 进入 LAST_ACK 状态。

第四次挥手：

客户端收到 FIN，发送一个 ACK ，并进入 TIME_WAIT 状态，等待 2MSL 时间后，关闭连接。



# UDP与TCP区别

无连接； 面向连接

数据传输不可靠，易丢失； 多次握手，数据保证完整可靠传输

数据无序性； TCP 数据排序

速度快； 速度慢    （UDP 多用于实时视频传输，多人在线游戏等）

量级：数据头8字节；  数据头20字节