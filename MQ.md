# MQ

## 为社么使用 MQ

解耦、异步、消峰。

解耦：便于开发维护，减少接口随系统需求的变更的频繁变动。

异步：多个系统的调用十分耗时，减少响应时间，提高用户体验

消峰： mysql 2000峰值。消息积压到 mq 中，服务器按处理能力进行处理。



1、生产环境问题：可用性降低

mq 一旦故障，整个系统全盘崩溃。

2、复杂性增加：

消息丢失

消息重复消费、幂等性：

消息长时间未被消费大量积压

消息一致性：多个系统成功消费消息，然而有一个系统未成功消费，响应结果是成功。



## mq高可用

集群模式：提高吞吐量

镜像集群模式：集群各个节点同步queue的完整镜像数据。非分布式。控制台新增同步策略。

